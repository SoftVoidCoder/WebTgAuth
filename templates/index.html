<!-- index.html -->
{% extends "base.html" %}

{% block head %}
<link rel="stylesheet" href="/static/css/home.css">
<link rel="stylesheet" href="/static/css/music.css">
{% endblock %}

{% block content %}
<!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –≥–ª–∞–≤–Ω–æ–π -->
<div class="home-particles">
    <div class="home-particle"></div>
    <div class="home-particle"></div>
    <div class="home-particle"></div>
    <div class="home-particle"></div>
    <div class="home-particle"></div>
    <div class="home-particle"></div>
    <div class="home-particle"></div>
    <div class="home-particle"></div>
</div>

<section class="hero">
    <!-- –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–æ–ª–Ω—ã -->
    <div class="waves"></div>
    
    <!-- –ü–ª–∞–≤–∞—é—â–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã -->
    <div class="floating-elements">
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
        <div class="floating-element"></div>
    </div>
    
    <h1>üéµ Tg Music</h1>
    
    
    {% if not user_data %}
        <div class="auth-prompt">
            <p>–í–æ–π–¥–∏—Ç–µ —á–µ—Ä–µ–∑ Telegram —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å —Å–ª—É—à–∞—Ç—å</p>
        </div>
    {% else %}
        <!-- –ö–ù–û–ü–ö–ê –°–õ–£–®–ê–¢–¨ -->
        <div class="listen-section">
            <button class="listen-btn" onclick="startRadio()">
                üéµ –°–ª—É—à–∞—Ç—å –º—É–∑—ã–∫—É
            </button>
            <a href="/profile#liked" class="profile-btn">‚ù§Ô∏è –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è</a>
            <button class="settings-btn" onclick="showPreferences()">
                ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å
            </button>
        </div>
    {% endif %}
</section>

<!-- –ù–ê–°–¢–†–û–ô–ö–ò –ú–£–ó–´–ö–ò -->
<div class="preferences-section" id="preferencesSection" style="display: none;">
    <div class="preferences-modal">
        <h3>üéµ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º—É–∑—ã–∫–∏</h3>
        <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–∏–ø —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π:</p>
        
        <div class="preference-options">
            <label class="preference-option">
                <input type="radio" name="musicPreference" value="liked" checked>
                <span class="preference-label">
                    <span class="preference-icon">‚ù§Ô∏è</span>
                    –õ—é–±–∏–º–æ–µ
                </span>
            </label>
            
            <label class="preference-option">
                <input type="radio" name="musicPreference" value="popular">
                <span class="preference-label">
                    <span class="preference-icon">üî•</span>
                    –ü–æ–ø—É–ª—è—Ä–Ω–æ–µ
                </span>
            </label>
            
            <label class="preference-option">
                <input type="radio" name="musicPreference" value="discover">
                <span class="preference-label">
                    <span class="preference-icon">üéØ</span>
                    –ù–µ–∑–Ω–∞–∫–æ–º–æ–µ
                </span>
            </label>
        </div>
        
        <div class="preferences-actions">
            <button class="apply-btn" onclick="applyPreferences()">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            <button class="cancel-btn" onclick="hidePreferences()">–û—Ç–º–µ–Ω–∞</button>
        </div>
    </div>
</div>

<!-- –ê–£–î–ò–û –ü–õ–ï–ï–† -->
<<div class="audio-player" id="audioPlayer" style="display: none;">
    <div class="player-main">
        <div class="player-info">
            <div class="track-cover" id="trackCover">
                <div class="cover-placeholder">üéµ</div>
            </div>
            <div class="track-details">
                <div class="track-title" id="nowPlayingTitle">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–∫</div>
                <div class="track-artist" id="nowPlayingArtist">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</div>
            </div>
        </div>
        
        <div class="player-controls">
            <button class="control-btn prev-btn" onclick="playPrevTrack()" title="–ü—Ä–µ–¥—ã–¥—É—â–∏–π">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/>
                </svg>
            </button>
            
            <button class="control-btn play-btn" id="playPauseBtn" onclick="togglePlayPause()" title="–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏/–ü–∞—É–∑–∞">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" id="playPauseIcon">
                    <path d="M8 5v14l11-7z"/>
                </svg>
            </button>
            
            <button class="control-btn next-btn" onclick="playNextTrack()" title="–°–ª–µ–¥—É—é—â–∏–π">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
                </svg>
            </button>
            
            <!-- –ö–Ω–æ–ø–∫–∞ –ª–∞–π–∫–∞ –≤ controls -->
            <button class="like-btn" id="likeBtn" onclick="toggleLike()" title="–î–æ–±–∞–≤–∏—Ç—å –≤ –ø–æ–Ω—Ä–∞–≤–∏–≤—à–∏–µ—Å—è">
                ‚ô°
            </button>
            
            <!-- –†–µ–≥—É–ª—è—Ç–æ—Ä –≥—Ä–æ–º–∫–æ—Å—Ç–∏ -->
            <div class="volume-control">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M3 9v6h4l5 5V4L7 9H3zm13.5 3c0-1.77-1.02-3.29-2.5-4.03v8.05c1.48-.73 2.5-2.25 2.5-4.02zM14 3.23v2.06c2.89.86 5 3.54 5 6.71s-2.11 5.85-5 6.71v2.06c4.01-.91 7-4.49 7-8.77s-2.99-7.86-7-8.77z"/>
                </svg>
                <input type="range" class="volume-slider" id="volumeSlider" min="0" max="1" step="0.1" value="0.7">
            </div>
        </div>
        
        <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç—Ä–µ–∫–µ -->
        <div class="track-additional-info">
            <div class="current-track-info" id="currentTrackInfo">
                <span class="now-playing-label">–°–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç:</span>
                <span class="track-full-info" id="trackFullInfo">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–∫ –¥–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è</span>
            </div>
        </div>
        
        <audio class="audio-element" id="audioElement">
            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç—ã.
        </audio>
    </div>
</div>

<script src="/static/js/music.js"></script>

<script>
// –î–æ–±–∞–≤–ª—è–µ–º –∫–ª–∞—Å—Å –¥–ª—è body —Ç–æ–ª—å–∫–æ –Ω–∞ –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
document.body.classList.add('home-body');

// –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
document.addEventListener('DOMContentLoaded', function() {
    const savedPreference = localStorage.getItem('musicPreference');
    if (savedPreference) {
        musicPreference = savedPreference;
        const radio = document.querySelector(`input[name="musicPreference"][value="${savedPreference}"]`);
        if (radio) {
            radio.checked = true;
        }
    }
});
</script>
{% endblock %}