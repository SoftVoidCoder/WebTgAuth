{% extends "base.html" %}

{% block head %}
<link rel="stylesheet" href="/static/css/profile.css">
<link rel="stylesheet" href="/static/css/music.css">
{% endblock %}

{% block title %}–ü—Ä–æ—Ñ–∏–ª—å - Music App{% endblock %}

{% block content %}
<div class="profile-container">
    <div class="profile-header">
        {% if user_data.photo_url %}
            <img src="{{ user_data.photo_url }}" alt="Profile" class="profile-avatar">
        {% else %}
            <div class="default-avatar" style="width: 80px; height: 80px; font-size: 2rem;">
                {{ user_data.first_name[0] }}
            </div>
        {% endif %}
        <div class="profile-info">
            <h2>{{ user_data.first_name }} {{ user_data.last_name or '' }}</h2>
            <p>@{{ user_data.username or 'username –Ω–µ —É–∫–∞–∑–∞–Ω' }}</p>
            {% if db_user and db_user.created_at %}
            <p style="color: #00c6ff; font-size: 0.9rem; margin-top: 0.5rem;">
                ‚úÖ –í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö —Å {{ db_user.created_at.strftime('%d.%m.%Y') }}
            </p>
            {% endif %}
        </div>
    </div>

    <div class="profile-details">
        <div class="detail-item">
            <span>ID –≤ Telegram:</span>
            <span>{{ user_data.id }}</span>
        </div>
        {% if db_user %}
        <div class="detail-item">
            <span>ID –≤ –±–∞–∑–µ:</span>
            <span>{{ db_user.id }}</span>
        </div>
        {% endif %}
        <div class="detail-item">
            <span>–ò–º—è:</span>
            <span>{{ user_data.first_name }}</span>
        </div>
        {% if user_data.last_name %}
        <div class="detail-item">
            <span>–§–∞–º–∏–ª–∏—è:</span>
            <span>{{ user_data.last_name }}</span>
        </div>
        {% endif %}
        {% if user_data.username %}
        <div class="detail-item">
            <span>Username:</span>
            <span>@{{ user_data.username }}</span>
        </div>
        {% endif %}
        {% if db_user and db_user.created_at %}
        <div class="detail-item">
            <span>–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:</span>
            <span>{{ db_user.created_at.strftime('%d.%m.%Y %H:%M') }}</span>
        </div>
        {% endif %}
    </div>

    <!-- –†–ê–ó–î–ï–õ –° –õ–ê–ô–ö–ù–£–¢–´–ú–ò –¢–†–ï–ö–ê–ú–ò -->
    <div class="liked-tracks-section" id="liked">
        <h3 class="section-title">‚ù§Ô∏è –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è</h3>
        <div class="tracks-grid" id="likedTracksGrid">
            <!-- –¢—Ä–µ–∫–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
        </div>
        <div class="no-tracks" id="noTracksMessage" style="display: none;">
            <p>–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç liked —Ç—Ä–µ–∫–æ–≤</p>
            <p style="color: #666; font-size: 0.9rem; margin-top: 0.5rem;">
                –ù–∞–∂–∏–º–∞–π—Ç–µ ‚ù§Ô∏è –Ω–∞ —Ç—Ä–µ–∫–∞—Ö —á—Ç–æ–±—ã –¥–æ–±–∞–≤–∏—Ç—å –∏—Ö —Å—é–¥–∞
            </p>
        </div>
    </div>

    <a href="/auth/logout" class="logout-btn">–í—ã–π—Ç–∏</a>
</div>

<!-- –ê–£–î–ò–û –ü–õ–ï–ï–† –î–õ–Ø –ü–†–û–§–ò–õ–Ø -->
<div class="audio-player" id="audioPlayer" style="display: none;">
    <div class="player-main">
        <div class="player-info">
            <div class="track-cover" id="trackCover">
                <div class="cover-placeholder">üéµ</div>
            </div>
            <div class="track-details">
                <div class="track-title" id="nowPlayingTitle">–í—ã–±–µ—Ä–∏—Ç–µ —Ç—Ä–µ–∫</div>
                <div class="track-artist" id="nowPlayingArtist">–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å</div>
            </div>
            <button class="like-btn" id="likeBtn" onclick="toggleLike()">
                ‚ô°
            </button>
        </div>
        
        <div class="player-controls">
            <button class="control-btn prev-btn" onclick="playPrevTrack()" title="–ü—Ä–µ–¥—ã–¥—É—â–∏–π">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6 6h2v12H6zm3.5 6l8.5 6V6z"/>
                </svg>
            </button>
            
            <button class="control-btn play-btn" id="playPauseBtn" onclick="togglePlayPause()" title="–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏/–ü–∞—É–∑–∞">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor" id="playPauseIcon">
                    <path d="M8 5v14l11-7z"/>
                </svg>
            </button>
            
            <button class="control-btn next-btn" onclick="playNextTrack()" title="–°–ª–µ–¥—É—é—â–∏–π">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                    <path d="M6 18l8.5-6L6 6v12zM16 6v12h2V6h-2z"/>
                </svg>
            </button>
        </div>
        
        <audio class="audio-element" id="audioElement">
            –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç—ã.
        </audio>
    </div>
</div>

<script src="/static/js/profile.js"></script>
{% endblock %}